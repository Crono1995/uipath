#!/bin/bash
clear
pvcreate /dev/sdd && vgcreate AUTOSUIT /dev/sdd && pvcreate /dev/sdc && vgextend AUTOSUIT /dev/sdc && lvcreate -L 200G -n rancher AUTOSUIT && lvcreate -L 56G -n kubelet AUTOSUIT && lvcreate -L 10G -n install AUTOSUIT && lvcreate -L 16G -n etcd AUTOSUIT && lvcreate -L 1000G -n datadisk AUTOSUIT && mkfs.ext4 /dev/AUTOSUIT/rancher && mkfs.ext4 /dev/AUTOSUIT/kubelet && mkfs.ext4 /dev/AUTOSUIT/install && mkfs.ext4 /dev/AUTOSUIT/etcd && mkfs.ext4 /dev/AUTOSUIT/datadisk && mkdir -p /var/lib/rancher && mkdir -p /var/lib/kubelet && mkdir -p /opt/UiPathAutomationSuite && mkdir -p /datadisk && mount /dev/AUTOSUIT/rancher /var/lib/rancher && mount /dev/AUTOSUIT/kubelet /var/lib/kubelet && mount /dev/AUTOSUIT/install /opt/UiPathAutomationSuite && mount /dev/AUTOSUIT/datadisk /datadisk && mkdir -p /var/lib/rancher/rke2/server/db && mount /dev/AUTOSUIT/etcd /var/lib/rancher/rke2/server/db && DISK=/dev/mapper/AUTOSUIT-kubelet && MOUNT_PATH=/var/lib/kubelet && UUID=$(blkid -o value -s UUID "${DISK}") && grep -q "${MOUNT_PATH}" /etc/fstab || printf "# cluster-disk-kubelet\n/dev/mapper/AUTOSUIT-kubelet %s ext4 defaults,nofail 0 0\n" "${MOUNT_PATH}" >> /etc/fstab && CLUSTER_DISK_DEV=/dev/mapper/AUTOSUIT-rancher && MOUNT_PATH=/var/lib/rancher && UUID=$(blkid -o value -s UUID "${DISK}") && grep -q "${MOUNT_PATH}" /etc/fstab || printf "# cluster-disk-rancher\n/dev/mapper/AUTOSUIT-rancher %s ext4 defaults,nofail 0 0\n" "${MOUNT_PATH}" >> /etc/fstab && CLUSTER_DISK_DEV=/dev/mapper/AUTOSUIT-install && MOUNT_PATH=/opt/UiPathAutomationSuite && UUID=$(blkid -o value -s UUID "${DISK}") && grep -q "${MOUNT_PATH}" /etc/fstab || printf "# cluster-disk-UiPathAutomationSuite\n/dev/mapper/AUTOSUIT-install %s ext4 defaults,nofail 0 0\n" "${MOUNT_PATH}" >> /etc/fstab && CLUSTER_DISK_DEV=/dev/mapper/AUTOSUIT-etcd && MOUNT_PATH=/var/lib/rancher/rke2/server/db && UUID=$(blkid -o value -s UUID "${DISK}") && grep -q "${MOUNT_PATH}" /etc/fstab || printf "# cluster-disk-etcd\n/dev/mapper/AUTOSUIT-etcd %s ext4 defaults,nofail 0 0\n" "${MOUNT_PATH}" >> /etc/fstab && CLUSTER_DISK_DEV=/dev/mapper/AUTOSUIT-datadisk && MOUNT_PATH=/datadisk && UUID=$(blkid -o value -s UUID "${DISK}") && grep -q "${MOUNT_PATH}" /etc/fstab || printf "# cluster-disk-etcd\n/dev/mapper/AUTOSUIT-datadisk %s ext4 defaults,nofail 0 0\n" "${MOUNT_PATH}" >> /etc/fstab && sudo yum install compat-openssl10 -y && sudo alternatives --config python <<EOF
2
EOF
